@model CreateMessageDto

<form asp-action="CreateMessage" asp-controller="Message" method="post" class="php-email-form" data-aos="fade-up" data-aos-delay="600" id="messageForm">
    <div class="row gy-4">

        <div class="col-md-6">
            <input type="text" name="NameSurname" class="form-control" placeholder="Adınız Soyadınız" required="" asp-for="NameSurname">
        </div>

        <div class="col-md-6 ">
            <input type="email" class="form-control" name="Email" placeholder="Email Adresiniz" required="" asp-for="Email">
        </div>

        <div class="col-md-12">
            <input type="text" class="form-control" name="Subject" placeholder="Konu" required="" asp-for="Subject">
        </div>

        <div class="col-md-12">
            <textarea class="form-control" name="MessageDetails" rows="6" placeholder="Mesajınız" required="" asp-for="MessageDetails"></textarea>
        </div>

        <div class="col-md-12 text-center">
            @* <div class="loading">Yükleniyor</div>
            <div class="error-message"></div>
            <div class="sent-message">Mesajını gönderildi teşekkürler!</div>
            *@
            <button type="submit">Mesajı Gönder</button>
        </div>
    </div>
</form>

<script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
<script>
    document.getElementById('messageForm').addEventListener('submit', function (e) {
        e.preventDefault();
        const form = this; // Form elementini sakla

        fetch(form.action, {
            method: 'POST',
            body: new FormData(form),
            headers: {
                'Accept': 'application/json'
            }
        })
        .then(response => {
            if (response.ok) {
                return response.json();
            }
            throw new Error('Network response was not ok.');
        })
        .then(data => {
            Swal.fire({
                title: "Başarılı!",
                text: "Mesajınız gönderildi teşekkürler!",
                icon: "success"
            }).then(() => {
                form.reset(); // Formu temizle
            });
        })
        .catch(error => {
            Swal.fire({
                title: "Hata!",
                text: "Mesaj gönderilirken bir hata oluştu. Lütfen tekrar deneyin.",
                icon: "error"
            });
        });
    });
</script>
